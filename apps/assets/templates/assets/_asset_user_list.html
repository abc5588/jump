<div class="wrapper wrapper-content">
   <div class="row">
       <div class="col-lg-3" id="split-left" style="padding-left: 3px">
           <div class="ibox float-e-margins">
               <div class="ibox-content mailbox-content" style="padding-top: 0;padding-left: 1px">
                   <div class="file-manager ">
                       <div id="assetTree" class="ztree">
                       </div>
                       <div class="clearfix"></div>
                   </div>
               </div>
           </div>
       </div>
       <div class="col-lg-9 animated fadeInRight" id="split-right">
           <div class="tree-toggle">
               <div class="btn btn-sm btn-primary tree-toggle-btn" onclick="toggle()">
                   <i class="fa fa-angle-left fa-x" id="toggle-icon"></i>
               </div>
           </div>
          <div class="mail-box-header">
              <div class="uc pull-left m-r-5">
                   <a class="btn btn-sm btn-primary btn-create-permission">
                       {% trans "Create permission" %}
                   </a>
              </div>
              <div class="" style="float: right">
                   <div class=" btn-group">
                        <button data-toggle="dropdown" class="btn btn-default btn-sm dropdown-toggle">CSV <span class="caret"></span></button>
                        <ul class="dropdown-menu">
                            <li>
                                <a class=" btn_export" tabindex="0">
                                <span>{% trans "Export" %}</span>
                                </a>
                            </li>
                            <li>
                                <a class=" btn_import" data-toggle="modal" data-target="#import_modal" tabindex="0">
                                <span>{% trans "Import" %}</span>
                                </a>
                            </li>
                        </ul>
                   </div>
               </div>
              <table class="table table-striped table-bordered table-hover" id="vault_list_table" style="width: 100%">
                  <thead>
                  <tr>
                      <th class="text-center">
                        <input type="checkbox" id="check_all" class="ipt_check_all" >
                      </th>
                       <th class="text-center">{% trans 'Hostname' %}</th>
                       <th class="text-center">{% trans 'IP' %}</th>
                       <th class="text-center">{% trans 'Username' %}</th>
                       <th class="text-center">{% trans 'Version' %}</th>
                       <th class="text-center">{% trans 'Connectivity'%}</th>
                       <th class="text-center">{% trans 'Datetime' %}</th>
                       <th class="text-center" >{% trans 'Action' %}</th>
                   </tr>
                  </thead>
                  <tbody>
                  </tbody>
              </table>
          </div>
       </div>
   </div>
</div>

<script>
var url = "{% url "api-assets:asset-user-list" %}";

function initTable() {
    var options = {
        ele: $('#vault_list_table'),
        toggle: true,
        columnDefs: [
            {
                targets: 5, createdCell: function (td, cellData) {
                  if (cellData === 1) {
                      $(td).html('<i class="fa fa-circle text-navy"></i>')
                  } else if (cellData === 0) {
                      $(td).html('<i class="fa fa-circle text-danger"></i>')
                  } else {
                      $(td).html('<i class="fa fa-circle text-warning"></i>')
                  }
                }
            },
            {
                targets: 6, createdCell: function (td, cellData) {
                    var date = new Date(cellData);
                    $(td).html(date.toLocaleString());
                },
            },
            {
                targets: 7, createdCell: function (td, cellData, rowData) {
                    var update_btn = '<a class="btn btn-xs m-l-xs btn-info btn-update" data-user="username123" data-asset="asset123" data-hostname="hostname123">{% trans "Update" %}</a>'
                        .replace('username123', rowData.username)
                        .replace('hostname123', rowData.hostname)
                        .replace('asset123', rowData.asset);
                    var view_btn = '<a class="btn btn-xs btn-primary m-l-xs btn-view" data-user="username123" data-hostname="hostname123" data-asset="asset123">{% trans "View" %}</a>'
                        .replace('username123', rowData.username)
                        .replace('hostname123', rowData.hostname)
                        .replace('asset123', rowData.asset);
				    $(td).html(view_btn + update_btn);
                }
            }
        ],
        ajax_url: url,
        columns: [
            {data: "id"}, {data: "hostname"}, {data: "ip"},
            {data: "username"}, {data: "version"},
            {data: "connectivity", orderable: false},
            {data: "date_created", orderable: false},
            {data: "asset", orderable: false}
        ],
        op_html: $('#actions').html()
    };
    table = jumpserver.initServerSideDataTable(options);
    return table
}
$(document).ready(function(){
    table = initTable();
    initTree();
})
</script>